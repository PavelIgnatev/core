const { MongoClient } = require('mongodb');

let db;

const DB = async () => {
  while (!db) {
    try {
      const client = new MongoClient(
        'mongodb://gen_user:35B%3DR9GTC%5Cq.Xv@82.97.255.185:27017/core?authSource=admin&directConnection=true'
      );
      const connect = await client.connect();
      db = connect.db('fucker');
      break;
    } catch {}
  }

  return db;
};

const getAccountCollection = async () => {
  return (await DB()).collection('accounts');
};

const insertAccount = async (account) => {
  const accountCollection = await getAccountCollection();

  await accountCollection.updateOne(
    { accountId: account.accountId },
    { $set: account },
    { upsert: true }
  );
};

const accountsString = `3e2127fad04e2d5a2d221639fd0a4b7996d065d9bc481e6b75b58652646369e5aed236865e288dc726f0926d18ba38c64b33cf1ea1a34cb1187609f57f8806cccfd5468b9ac4dbd87821158b5db7e2c8dc1ebda9d9b0c1bc188829a1e54ce54f686ee52795727c170f2ab518bc953100bd6b8790549fab87d5dc1b575d49137217829694d0c4b09358b8f05f064f1814febcc2bf8cd89a03ac1d622911741f378b60c17fc2cd8bcd138c96737b038e48172ed31dedf307a06e19c2570f5e86f2f28ef514c989deaf8e99411e2cdd74562d1b38e2f03f0c114e3b03e560a47b7d97c4580d6c458109b1fc2084fa2f8482b1d063ca60676a132a95d7c18bdd4a77:4
00ef9a4f4f79d2e98b24524d9e38472e0b3018d7a410efaa410c9f1309aedca219c0f9cda4e291eafccc9d2bbdb02d8bb2f3f3f806c167b0fb81d027042494f4cffec5a685215d9c9d1f7245d6e959be199d38461db820c7d21f3e48bad647e0c09ebd5cf1acff461dcf6d021eae2a13ca03a1adff2666b20baa4bf198d9f513d6710d48a38bb435f1d998bdd712c49e2ffdf257a4fb40b27fa6a796c8a61d878f89885dc0b90cd69dda9d62d390d66cc4467461a17e69c78a74b40fc43dcd0106a9e5fb34827bfa44fb250fce9d3b7f8e12363802450fdaa7801bdc7e7212335e7c39f5acd6c4f63834e94130d108acacda12ef24056f8ffd5eb6090cb94ceb:2
18188e434bd0f59d7725c0e07a3b97740da53681f25e2804d73719ed4314629d210541a71cbbc127d1e7b0d4db80cc5e5c01a5b807ed42430df591d8e719ab403a6980dea86c159181d145541c00aeb9f95f26731608165351e1e76eb5cd29f938b0afac70310f789c482640917c23b69f736aa6f605e60dc988910ad136ba2b1c62f3815bb510bcb1aafee51aa6cc0005ad74d9e7b4db5412d2a7fc1f35d865c568a9897f4f806ec64cd7b14524e7b278f64e99f5ddbd0c9824cc00b1a4e441aeb55daa9255f40dcb5278703fc8c2d77c1bad87901e9f6d9754ed723d413a764aec926b101367bd6d98a139ecdfe5ea3656639313b014b1bf7a21622096f443:2
1920a544b5bcf54d7ab2807131b844ef0249c34e9b5b6a09ec2f8084e84b73b9cece113c6e018d6d00154fc36449579de51e7ab597f9e5da19cbd17d3aa77d34e40ffab65c93915e3c1b2f6f262682c36cd3d805d380151b8926e372b8bf06901d4c15d351a4b37d23181718f129fd6a188df40e075760db5e4eb8a323f38dadb6a62069fcbe2d94595abb5fd72acd267c58486bf930a243bf67aab56aafd1105c996cefcf102e80370e6433b683acdb7e1999855f42bfb5a6c1af733e2f7a781ab74ef401ce235ad5dcf94ef9cb964472af74dccb301bbefc189e82003d644a9e8b7124a64fe4c29904ee42582a3cb56d146d7e1ccbcd10f1b30e82521e54a0:2
5f35f22448fd398935a24826a21d8ab8dc3b0a2df5d607de8425176f1294bd28274db06cabffc6f92a9e34e713f7d3638538a0cb06898f6cb44bc8b97dbd4dbfee7acf544762d974faba6964f53bc55f5b21124897447df73fe64657133b1a57dec6146bc5444040272c76eff047c2716060eb4b3b8f1f96e7197293e48622eca463ffc862302147144eca980b9ab489a5bbceb008531b73021f2063278e7ccf56ff1b8a364b694aef9eb34567e3872e41d46c94b62d32012e9b44a18e7256d7161b7854e068be116db01010650d6bce3345c47d5f5de67e400b173a482c0d718e7a43ec62d557baafef9914b31e908ea55583db833022640da92fea82ecce7f:4
5a8bba177da715b77309f5bc9d79fd6a924369cd0cb4fb1a2ee4b3777694d1090bb1924340a0444b5afc708059b58be2f603fe03f17abfb75b46b04818a5e97645a20d2b3c493470462234ec8f098e7376c6c630c9e2b05f30d957343546fa75ec4af68334182990be4f70693780e9196c3f35b36a3e6749fdcd469b14e9ee7b32989005fa59d8f96c4345f1f8466e3cd3503e05549928155c74370c7995264e82a80d25a3a74ac628b0f19ff7256aec77c66e2084f27512136d087936dcda173a54856cf03b039450dc331d6647dc570adc7b8927acfaeace979ad333256a870bc1323944d59cd62cf387d6d1c5640f782e458319f11cb8602b91e5da2df20c:4
74534fa985925450cf2442b18774c89b5364f4188ef9cc3eade31077b78a24080ee948099e8acb28eb8eda7fb3dfa61d1056b945c71e2111307c470dfa56827d227a69473b23ed37dfb9b8b96bd04aa219511c6e8f60352d18b0bd15596956140b6c93084e7e8bba754e3edb1d07c4130d971f58d4c4d9d3dad8f47d5a322a175964c69c7f20c04061be1286f6f06fb1fca8d297da4e6f45fbf937cec3946acd7283b0758b84896ce661bfaa501d5e3a93faedae059f4e523d2ca6979b461c98522f18fef4e800bec2a3ecbc3ea1d4447765e5d4d93db592fda7f471990f0649d36739a936cc50dd9e5ca559232b13c297c157f8050cad7970fb2bb66a217fc8:4
46989cac0323e1e105c78b15a4782243decd675cf993134e057c9ae8d4378a1eb86c0b20d5163005f7df9aeb932fc80f2f4e2dbc623339dd6fec2f331f22d27cb9b809a450a14328ef1d773e41462fb1ec7361c398c7de527c3d789253435f1783a83f70d15cc0c750cc8ba016dbba9312df347d1cf21d5d87a8e32f14929a0cbd30bc93ca354c496f327b4742613ed5cb2b485710f819d90684948b5fa0b6a982573b28b25351bebb7545ca4ba4fda7f0157dfa06f207b886c49455cfbfa474768ea10b246d339e23d51a8f39541b927b4107fda8f06db8a433c8519dcd1fe19e2dfde2c93008035380eed22f9428586b5edfef28adbc7d6214292c8c9c660a:4
81fbbf00570324157f4c935cc2af294e13bae24c8c50b811edccbdf9f57da69f72a5ac1ac4efb44adb3df5a12d942ef391b2438acdcb05af3a51b97a3871beefa912167c70856c06c8f0ce51448e6b61e1883b1ad8a2762ef440e8dae3830b81e5e6525aecbb8293b9ea41dc77e19b7d88a90ffe8f2d1c0f46b28c459873e69052681174bf59f7e5aa51e5e7f7c8114ed576a9f8e2e5f32767f7893d55526113dd8769747a6334e71663bfb7bf99bbb2bd0cd85dd09851424c785320accc19699bb586706a26fc19a38136873d16505f5ce87446f37b611958df4635ec726ee6fba3c0ea834445cebc372ea217ee30c88927536bef50404981abc6f8125bb547:4
982277d5a6e839f4be433c09fd85465ff0b53ddf34d712fd074af300767cb0314bb67e87fb4fb9ec72f72c9f8620ac281a100f5a21d8f42fedd6a04177ad7ebc949d285505b9e5c60388020816a041e0096b62163473894bdcfd3b1553f12dea3c5446e992a8bb36e0f1d4a726f693e8f300a135a5538a69a2eb0d18426eec7353ef3541426502ec913aee33066c2244d80014e00b9f8e445798505ad0d4a1f6fa2bbeb5a8646a4ac614f621aefd8cb8c9aacea5d4e8daead322e45217b58cba7deb04d505476609504c7feb3aa1ce4e1f4cb3b5d77bb9922630edb730052b0827daacd371cfa079cd1d7c80b23e64d76418b3fe14866a0e2a097885b3ca7c30:4
734e867981f60a4a533d24228350de35126e5ba519489ed1dfcf32fa50d3af6b8cc7b636085e82420acc7bf379e738cc20b17199fec0d80105d93ac6f858c6072badac3b2071566ea34bb7820d3737d5a691d466730503d7016c05a08f51c1d7a10ebe174e9092b26e2b03cedb676e686dc63d1b10c78fef843a9c930f889cc772ee609e6c0ed7e457416503caa5f815a6968a4095ac520ee859987f94d8269cf1875420eb2b02ddf278d582629524f67e3761ce22f8ec47d07c76065b78cecb64ce7b0815d9a0234e8227ce227da606e0f0447f7e8eb16ec03817ee4871b6058a51df6f1c8a2f0515c10f637f295d97e373d8ea47c7a30695ce9e6e356e9a80:4
3fb60fe27b7c9693e92c76eed2cfe48b2696851723a13151c32f753b1bab3ba26e2308429b3701c2ccda62a3ce02776a64f3b7b580679861d0759cf4f9169bfca6d8e1c01c8709df84c5bed864943478d79a80edb50bd8e355c9642751c2b4dadc5ce3af10aa3572368383f9413b0cd0acc09180ffdd85f6c436fde5e85aaeae70a29df682f8f915e94c9b6be40e20bd1388b87dc67c3d2e6db361b32d1baf93946cfa61d91b0ccc3f462416f0c5f8cae33b2b60cad319af2020786d5d4a530672ff899605ade69caf49a6de261d639455998461e4ec932c7757f21e40784f8d091b51073ed1387aeba22a18766a6e21238c523deb344ca68f64d1367e41e206:4
0a97c58e3822ba09a4263621bb92e15ae6e9d6c84b62406a5f87bc08831d28b9c46114bda287a8b246a221c90ee6cb30909c017cc09aea08ee4f8b9bf5721b871b3ff667107039e0c2b12d653ad957de73f27759249f3f1cc4f3e8f21fed5f98ac3fdcee21610e8b17cd9e982989557b898c3cb486c0a3b1ec98a52aeba98ef38a85c521dbad0ebb8642a5bb2a5aecaf3d4bcf95cca77b2a06c71641efc200a7e4391eb6d1b746f752d9ae7668dfa6cbd48047f1d78d88841da101b5c6fda6290e6055c58eb59315bc2aca68b52fecaa3d38e9f836cf1a92807043b397affbb66e046825adc054957aca61a338e49cde2378480dfeb157c2b1510a607c6c38c2:4
23e36cd05b94bc905fa4f2b70acf0e1de2be57b3ec81284b667576ba243c86a5c0338484092caaf0de86c6760938729be296c833b15c770e4544dd2568b09344e4e2ab60d150cee5adb7440d0d2a583b4eb05b08dec933c9512ed29ae063a89baded6ab1f09fcdf2da9407d6428a87035ae3509396a7ac89075a0fc5a877d76357459f6e7845ff7142632bcf0a72d377adb5c1f026b70eb07110ea4d522e58fa64d5eeca6d0fb551949bc81ca6471c937c12b28586d832b6735bbe78b001f7cf8f5c528e34cf102e8b93607c12696973611c42455e64570eb4777c211513de5c4f35862e44867074b5dd8077f4fb22989b7843c85a648fbdb562de2a54e51e59:4
1517a7aea53ee32a7bad90a08acdd62c672fa37c601c1b0c4efb10d30c7c775efb1a3d11ec094fd7b71f6bbb05b94b219b02dd8c2e708477646fe2dcfa652f7eef6a52da5dbc2b85e38b5dd1caf06113eadaeedefaee8ed9a6da70437d12bb7f9b749bcd8b674a0a7bc370de21489c828a36b76cbb220c7b9800b0437e7c89a289d71b1df9ba8f47e7c3bf9ecab6a3f9bc643b69c414541a69c03b91d956d2838bd04e03ba4a933cd38813e19246f93b885f8a38ffc68a55844902f48b392076acf9f817c9531a3fd124d9ba01c2bb42f8959a198ee519bdd299e37120b381fdb05618d05678af2ddb68b7b66549fef87b7ae094e3c4202008c41199223d2e35:4
4786b17d024bf688d82f8e11a7b5e5c039eba81e8828df3bf6dbbb39986dc0c24db011d4dd67df819554ce5bec754b10c83311c33f8b4178f876ecab8960f98d7674c78bb9bfeb14fdff2ba429c2944d359c03f0cbeefb6c4a5a78dae7fd15cb2afaa44b977f29ca0bf4cc90b5018c1e41287b17e2c4c2fa4bff2c7fcc106475bb9796e3852d59e86fe75948c98a02bda035d4da3df9d5ee84266c7a147cba1dd3b857ea4702ef328aa950108e5ffe50b1d43fe678cfdf5f2cc3a98774686208ed4f6f713cb0c49f245178490de1020f59757fca291fc0a52ec1e2b22c2619e5b59d5e78cbd29fb775cec154ffc4ca88ffba1a6b6efc1fc57457f36250908fd2:4
59f75aba0dc02ba9aefbfa1564fef65c8a8aad490a6d746d0841d3543af00a09ec047acfaedb004180c5ea07479ab4600f043fedaacde6836394079d75627a5a92fac1ff2cbca1ebc4fdea53976229c76671e0f2c7eff4c968e2605e2a133faf84ac3d671f2e0d1e3144d9fdb48bf03b58af949d718df3d1f4dc68cdea24d4b6e8fbd128fd7e22d1089305cdb4b9f9417f60f820e90ff9679e2edd0d09e93dcc8d0733f5e5ee2ed1fec823b1bb4ef2d9c479184589319753bb1115eb86998519f1f96be3ce64ba1124b7380218a07a859ed1a88fe24a17bc3ef8182c499a3adec10c55df77eea7a566ef6c2904d88528ae1fd773c21086927d1224e2ea67b505:4
9c1919dc1c101e56a25ded7fcb5bed7af08deb3c38984c89879cf18f6e3799cd87b36a34ba17f085a79ac9d08601e7ae22fec015b1d3a0e37b5f61f48b1f896d65c63947fd57cf54df79e19045aabfc6010e5cdb80d600c633f9de1984f4c19352aea1ff549f0e3b5dd0f372f577d799ee77d4f5e7869bc4fb0df42650954d75808b7de90dba823df99992854946f44e110d13643114428344fc8e4e7d8e52cb9beaa62117fa47af5587429a159b6470d7b8e5b9ae4f108fca12cc643048b670f87579a46dc4c6b590c2a0be133d2d4918de3e5b0236724dec99be5ef13c39afb151a0ccda88769eb1d2f9b21b3120d7f54f3ccbe1e9d67e8bc3fceee9c2d0bf:4
5b0056ab9c2135c3dc065b45f96b9e4c8e310a65b0904dd7d2a92a0f920219f2c1a5ae8288699edcd650068b9acfcfc66cb20630ded998a8e0f76e362c3177ffafac2d987e15b23dc182341be0e7ed0b5659a692483585b6d47ea72d5108ff278f8e105df37ca9d409e766a6ee5b9c0274c6c88a9412eba659b750a4703d14290e9f4ecd7f2c1e21140a8bc951ab72c1b6154c94f6dd3dcad83ca2a622f9aec0ef8af749f28ea0c48eba9e2858b0573849dd32b85f11e797410285376b19467abfa2b218768a75c11ffa115929d854ef1bf6eec11c6a5d64371c3c1db0a28ee7edad78eee9df2a5bb7a352938c9ca396a61c6c2644c43e55ec10a00ea3103d38:4
56587232c57390ba63af3504b7d73c51f884b48fc27415839e6456fdae7999e5cff6ffcac969a2d4459409fbfb30e6e6a462e0d2a5bd7b977faea5f6028f20e932a3051cee8c18d7fe08c7a7ca400ba78bcf6da1781ae8174419a6d14b5ce31d24b6eb264e47ceb951252f587e41afc07ded54a95a0ca3f09f667bc7fba1393d0a917f9f50011182e1788b40b4881412cffbafc740b600a28ca5451a62aa26e95029fcf8f5a4c43f7054eb2f472d903bc51eab4cdcc14d679dfafa95540d75e16515ebaa6c9e763e2c9438e6dba8cee8b489b33ad860e0d42b6b0cc507bd9728531c56bcec7d25083bb9278ef5697548fcb232b3a9c2782448706019e2005b02:4
2ab9a3dca1007bd97a328c33aaa5c31f00c4dfd270b57bbc3d2ae6d8ef6a34298f0d79c49f5b47910b891887bbc6b224e9ad92d54668433df1b78599641a1b3bd2087fd5b022e04d29443caf050e70f5ba4c9de31f001c3f7cafa59eb26ebbfd106f39aafa78fe94cbdb5eeb6b909dd84d7393bdf3894a53620067d3aca1a125acc0d00e9397d4e1e4c30eb0f67012d0ae3f2e95d066ec97b488d0e8f73a8b1d8eae67f26dd7de0de86bde48685f4d08eb3c1a6655de0fa283520565374de654c72091a7bb057d7da459987275c59674152ad88e380b669fc4f78e2cc48577097b7989d18885df948884c38b151696704eeaa0b71cd75e38e2dad7a12df12ea9:4
78dd88da1e2dde2c2795b527da1cd67ab77a2605ec070ce513b9e723c3c376b6bf3a073e0e06051219c5b2ff0561cb29e3e54f54706f31792ea68476d35d9618fd3054126364df8597061fde0b99e8bf5e8aac7f9f6a770b60ab9f29e1c07e859fa04ec3e7dd5717f337e3ed330b7863a91cef65ea369bfbfe21f5ee08bb43b58eea3d18e4da66f7dfda67aecf6e705ad3f4ce8a8cd47cb9a00b247f550d76f1e24ffb699a84159c7f81de31c98f639419e1ae09990a202da28a2e93e345bb474847ee37804193304b6f698b9fdc6b1acc490a666ccc51e88c8304c8a628066d8da647677d0dca56a93048404b674f4286f74c53b837b81d684ce0e77dbce2dc:4
901b929a29985af2f59c8ac8c3599fe4a130a8ae0cc9ee1a4e48a868ed283ddc521f3a85632b0c9f264a3c4b6972446bf590b932c085318ca236c23dc25c17750354e178cb9fb6b07d26c240f0c0858c40ad910de1b6b605bf3e43b407b271525bc419c191c3130cb339e4422e0a3eab32cd9d3f3d9b076767226887dba571417a09687dbb7282d5e44f1cdd4ff37c9f0359549c6d224a1c6e76a66935ed866c9a24fb616fcdefc22ad713fabfc598ab067f57d3a39069544509b571aee05d7ba86ba8cd14d449d95463a0116e952cb32064fd2f699cf7eae623ee06576070d58c4ee86e6f713f4d1b550d02df63600f3d6fdc8c34b1b56e8dfa0e201f1d1062:4`;


//  .map((e) => `${e[`dc${e.dcId}`]}:${e.dcId}`)
// .join('\n'))
const accounts = accountsString
  .split('\n')
  .filter(Boolean)
  .map((a) => {
    const s = a.split(':');

    return { authKey: s[0], dcId: s[1] };
  });

const zanos = async () => {
  try {
    for (const account of accounts) {
      const username = account.authKey.slice(0, 32);

      const data = {
        accountId: username,
        dcId: Number(account.dcId),
        prefix: 'zanos-angl',
      };

      data[`dc${account.dcId}`] = account.authKey;
      await insertAccount(data);
    }
    console.log('VSE');
  } catch (error) {
    console.error('Ошибка при обработке файлов:', error);
  }
};

// Вызываем функцию zanos
zanos().catch((error) => {
  console.error('Ошибка в функции zanos:', error);
});
